
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Arc: Bilbo Baggins</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; background: #f9f9f9; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: #2c3e50; margin-bottom: 5px; }
        h2 { color: #7f8c8d; font-weight: normal; margin-top: 0; }
        .arc-viz { width: 100%; height: 300px; margin: 30px 0; }
        .events-container { margin-top: 40px; }
        .event-card { 
            background: white; 
            border-radius: 4px; 
            padding: 15px; 
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .event-title { color: #e74c3c; margin-top: 0; }
        .event-text { color: #333; line-height: 1.5; }
        .timeline { 
            position: relative; 
            height: 4px; 
            background: #ddd; 
            margin: 40px 0;
        }
        .timeline-marker { 
            position: absolute; 
            width: 12px; 
            height: 12px; 
            background: #e74c3c; 
            border-radius: 50%; 
            top: -4px; 
            transform: translateX(-50%);
            cursor: pointer;
        }
        .stats { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 20px; 
            margin: 30px 0;
            background: white;
            padding: 15px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat { 
            flex: 1; 
            min-width: 150px;
            padding: 10px; 
            background: #f7f7f7;
            border-radius: 4px;
        }
        .stat-title { color: #7f8c8d; margin: 0; font-size: 14px; }
        .stat-value { color: #2c3e50; margin: 5px 0 0; font-size: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bilbo Baggins</h1>
        <h2>Character Arc Analysis</h2>
        
        <div class="stats">
            <div class="stat">
                <h3 class="stat-title">Mentions</h3>
                <p class="stat-value">1</p>
            </div>
            <div class="stat">
                <h3 class="stat-title">First Appearance</h3>
                <p class="stat-value">Segment 0</p>
            </div>
            <div class="stat">
                <h3 class="stat-title">Last Appearance</h3>
                <p class="stat-value">Segment 0</p>
            </div>
            <div class="stat">
                <h3 class="stat-title">Location Count</h3>
                <p class="stat-value">0</p>
            </div>
        </div>
        
        <div class="arc-viz" id="arc-viz"></div>
        
        <div class="timeline" id="timeline">
            <!-- Timeline markers will be added dynamically -->
        </div>
        
        <div class="events-container" id="events-container">
            <h2>Character Events</h2>
            <!-- Event cards will be added dynamically -->
        </div>
    </div>

    <script>
        // Character arc data
        const character = {"name": "Bilbo Baggins", "attributes": []};
        const events = [];
        
        // Create timeline markers
        const timeline = document.getElementById('timeline');
        const timelineWidth = timeline.offsetWidth;
        const maxTime = events.length > 0 ? Math.max(...events.map(e => e.time)) : 0;
        
        events.forEach((event, i) => {
            const marker = document.createElement('div');
            marker.className = 'timeline-marker';
            marker.setAttribute('data-index', i);
            marker.style.left = `${(event.time / maxTime) * 100}%`;
            marker.title = event.description;
            
            marker.addEventListener('click', () => {
                document.getElementById(`event-${i}`).scrollIntoView({ behavior: 'smooth' });
            });
            
            timeline.appendChild(marker);
        });
        
        // Create event cards
        const eventsContainer = document.getElementById('events-container');
        
        events.forEach((event, i) => {
            const card = document.createElement('div');
            card.className = 'event-card';
            card.id = `event-${i}`;
            
            card.innerHTML = `
                <h3 class="event-title">${event.description}</h3>
                <p class="event-text">${event.segment_text}</p>
            `;
            
            eventsContainer.appendChild(card);
        });
        
        // Create arc visualization with D3
        const arcViz = d3.select('#arc-viz');
        const width = arcViz.node().offsetWidth;
        const height = 300;
        
        const svg = arcViz.append('svg')
            .attr('width', width)
            .attr('height', height)
            .append('g')
            .attr('transform', `translate(0, ${height/2})`);
            
        // X scale for time
        const x = d3.scaleLinear()
            .domain([0, maxTime])
            .range([0, width]);
            
        // Y scale for importance
        const y = d3.scaleLinear()
            .domain([0, 1])
            .range([50, -50]);
            
        // Create line for character arc
        const line = d3.line()
            .x(d => x(d.time))
            .y(d => y(d.importance || 0.5))
            .curve(d3.curveCatmullRom);
            
        // Add axis
        svg.append('line')
            .attr('x1', 0)
            .attr('x2', width)
            .attr('y1', 0)
            .attr('y2', 0)
            .attr('stroke', '#ddd')
            .attr('stroke-width', 1);
            
        // Prepare data points with interpolation
        const points = events.map(event => ({
            time: event.time,
            importance: 0.5
        }));
        
        // Draw line
        svg.append('path')
            .datum(points)
            .attr('fill', 'none')
            .attr('stroke', '#3498db')
            .attr('stroke-width', 3)
            .attr('d', line);
            
        // Add points
        svg.selectAll('circle')
            .data(points)
            .enter()
            .append('circle')
            .attr('cx', d => x(d.time))
            .attr('cy', d => y(d.importance))
            .attr('r', 5)
            .attr('fill', '#3498db');
    </script>
</body>
</html>
    